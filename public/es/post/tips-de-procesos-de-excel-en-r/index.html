<!DOCTYPE html>
<html lang="es">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="es">
    <meta name="color-scheme" content="light dark">

    

    <meta name="author" content="Andres Felipe Insuasty Ch.">
    <meta name="description" content=".blocks_style { font-weight: bold; background-color: whitesmoke; color: black; font-style: italic; font-family: Monospace; }  Procesos de excel realizados en R 1. Guardar en varias pestañas de un libro Dividir una base de un libro de excel en varias pestañas teniendo en cuenta una columna, resulta facil con el uso de purrr.
 separar archivo por columna  library(dplyr) archivo &lt;-readxl::read_excel( glue::glue(&quot;{here::here()}/datos/50_Mejores_Canciones_Latinas.xlsx&quot;))  Seleccionar columna a separar y convierte a lista  columna &lt;- archivo %&gt;% select(País) %&gt;% distinct() %&gt;% as.">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tips de procesos de Excel en R"/>
<meta name="twitter:description" content=".blocks_style { font-weight: bold; background-color: whitesmoke; color: black; font-style: italic; font-family: Monospace; }  Procesos de excel realizados en R 1. Guardar en varias pestañas de un libro Dividir una base de un libro de excel en varias pestañas teniendo en cuenta una columna, resulta facil con el uso de purrr.
 separar archivo por columna  library(dplyr) archivo &lt;-readxl::read_excel( glue::glue(&quot;{here::here()}/datos/50_Mejores_Canciones_Latinas.xlsx&quot;))  Seleccionar columna a separar y convierte a lista  columna &lt;- archivo %&gt;% select(País) %&gt;% distinct() %&gt;% as."/>

    <meta property="og:title" content="Tips de procesos de Excel en R" />
<meta property="og:description" content=".blocks_style { font-weight: bold; background-color: whitesmoke; color: black; font-style: italic; font-family: Monospace; }  Procesos de excel realizados en R 1. Guardar en varias pestañas de un libro Dividir una base de un libro de excel en varias pestañas teniendo en cuenta una columna, resulta facil con el uso de purrr.
 separar archivo por columna  library(dplyr) archivo &lt;-readxl::read_excel( glue::glue(&quot;{here::here()}/datos/50_Mejores_Canciones_Latinas.xlsx&quot;))  Seleccionar columna a separar y convierte a lista  columna &lt;- archivo %&gt;% select(País) %&gt;% distinct() %&gt;% as." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.ainsuasty.com/es/post/tips-de-procesos-de-excel-en-r/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-23T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-08-23T00:00:00&#43;00:00" />



    <title>
  Tips de procesos de Excel en R · AINSUASTY
</title>

    
      <link rel="canonical" href="http://www.ainsuasty.com/es/post/tips-de-procesos-de-excel-en-r/">
    

    <link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="/css/coder.min.ab8a78871b01d3ab8e6830af3ac02052ccdcfcce9557010191ae7f292082a4c5.css" integrity="sha256-q4p4hxsB06uOaDCvOsAgUszc/M6VVwEBka5/KSCCpMU=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="/css/coder-dark.min.51c0e6757ae35097fbc2c4659dabf099de25f5230d514d8072e3d6abe9356626.css" integrity="sha256-UcDmdXrjUJf7wsRlnavwmd4l9SMNUU2AcuPWq&#43;k1ZiY=" crossorigin="anonymous" media="screen" />
      
    

    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.82.0" />
  </head>

  
  
    
  
  <body class="preload-transitions colorscheme-auto">
    
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/es">
      AINSUASTY
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/es/post/">Blog</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="http://www.ainsuasty.com/">🇬🇧</a>
              </li>
            
          
            
          
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://www.ainsuasty.com/es/post/tips-de-procesos-de-excel-en-r/">
          Tips de procesos de Excel en R
        </a>
      </h1>
    </header>

    
<script src="http://www.ainsuasty.com/es/post/tips-de-procesos-de-excel-en-r/index.es_files/header-attrs/header-attrs.js"></script>


<style type="text/css">
.blocks_style {
  font-weight: bold;
  background-color: whitesmoke;
  color: black;
  font-style: italic;
  font-family: Monospace;
}
</style>
<div id="procesos-de-excel-realizados-en-r" class="section level2">
<h2>Procesos de excel realizados en R</h2>
<div id="guardar-en-varias-pestañas-de-un-libro" class="section level3">
<h3>1. Guardar en varias pestañas de un libro</h3>
<p>Dividir una base de un libro de excel en varias pestañas teniendo en cuenta una columna, resulta facil con el uso de <strong>purrr</strong>.</p>
<ul>
<li>separar archivo por columna</li>
</ul>
<pre class="r blocks_style"><code>library(dplyr)

archivo &lt;-readxl::read_excel(
  glue::glue(&quot;{here::here()}/datos/50_Mejores_Canciones_Latinas.xlsx&quot;))</code></pre>
<ul>
<li>Seleccionar columna a separar y convierte a lista</li>
</ul>
<pre class="r blocks_style"><code>columna &lt;- archivo %&gt;% 
  select(País) %&gt;% 
  distinct() %&gt;% as.data.frame()

lista &lt;- as.list(columna$País)</code></pre>
<ul>
<li>Crea lista vacía para almacenar bases</li>
</ul>
<pre class="r blocks_style"><code>bases = list()</code></pre>
<ul>
<li>Guarda cada base filtrada con el registro de la lista en una lista de dataframes, adiciona nombres a los elementos de la lista y mantiene las bases que contengan registros</li>
</ul>
<pre class="r blocks_style"><code>bases &lt;- lista %&gt;% purrr::map(function(x){
  archivo %&gt;% filter(País == x)
}) %&gt;% 
  purrr::set_names(columna[,1]) %&gt;% 
  purrr::keep(~nrow(.)&gt;0)</code></pre>
<ul>
<li>Escribe en un archivo excel la lista de bases</li>
</ul>
<pre class="r blocks_style"><code>writexl::write_xlsx(x = bases,
                    path = glue::glue(&quot;{here::here()}/datos/separado.xlsx&quot;),
                    col_names = TRUE)</code></pre>
</div>
</div>

  </article>
</section>

  

      </div>

      
  <footer class="footer">
    <section class="container">
      
        <p>Personal Website made with ❤️ R + hugo + Github + Netlify.</p>
      
      
        ©
        
        2021
         Andres Felipe Insuasty Ch. 
      
      
         · 
        Desarrollado por <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
    </section>
  </footer>


    </main>

    
      
      <script src="/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js" integrity="sha256-A7F3afT5GuNWZ&#43;HyocqMFvUFYlds&#43;Q/zKzF5kmkU2qU="></script>
    

    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-176122758-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    

    

    

    

    

    
  </body>

</html>
